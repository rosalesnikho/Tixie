<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Title</title>
    <th:block th:replace="partials/common :: head">

    </th:block>
    <link rel="stylesheet" href="/css/custom.css"/>

</head>
<body>
<div class="uk-container">
    <th:block th:replace="partials/common :: navigation-index-page">
    </th:block>
</div>

<div class="main">
    <div class="uk-container uk-container-large uk-align-center">
        <div class="tixie-all-tix uk-margin-top">
            <div class="tixie-all-tix uk-margin-top uk-margin-bottom">
                <h1>
                    All Tickets
                </h1>

                <div class="uk-card uk-card-default uk-card-body ">
                    <ul class="js-filter uk-child-width-1-2 uk-child-width-1-3@m" uk-grid="">
                        <th:block th:each="ticket : ${tix}">
                            <div class="uk-card uk-card-default uk-card-body">
                                <h6 class="uk-margin-remove-top uk-text-bold uk-text-uppercase tixie-ticket-name"
                                    th:text="'Ticket ID: TX-'+ ${ticket.id} + '-' + ${ticket.specialization_id.name}"></h6>
                                <p>
                                    <!--                                    <p th:href="@{'/tickets/status/'+${ticket.statusId.id}}">-->
                                    Status: <span th:text="${ticket.statusId.status}"/>
                                    <!--                                    </p>-->
                                </p>
                                <span class="uk-label" th:text="${ticket.priorityId.name}" th:classappend="
                                        ${(ticket.priorityId.name == 'low' ? 'uk-label-default': '') +
                                        (ticket.priorityId.name == 'medium' ? 'uk-label-success': '') +
                                        (ticket.priorityId.name == 'high' ? 'uk-label-warning': '') +
                                        (ticket.priorityId.name == 'urgent' ? 'uk-label-danger': '')}"></span>
                                <p>Created on: <span th:text="${ticket.issue_date}"/></p>


                                <a class="uk-button uk-button-default" href="#modal-center" uk-toggle="">Open</a>

                                <div id="modal-center" class="uk-flex-top" uk-modal="">
                                    <div class="uk-modal-dialog uk-modal-body uk-margin-auto-vertical">

                                        <button class="uk-modal-close-default" type="button" uk-close=""></button>
                                        <div><img style="height: 165px; width: 205px;" th:src="@{${ticket.imgUrl}}"/>
                                        </div>

                                        <span class="uk-text-center tixie-tech-icons" th:classappend="
                                        ${(ticket.specialization_id.name   == 'electrical' ? 'tixie-tech-icon-elec fas fa-bolt fa-2x' : '') +
                                        (ticket.specialization_id.name     == 'plumbing' ? 'tixie-tech-icon-plumb fas fa-tint fa-2x' : '')  +
                                        (ticket.specialization_id.name     == 'hvac' ? 'tixie-tech-icon-hvac fas fa-thermometer-three-quarters fa-2x' : '') +
                                        (ticket.specialization_id.name     == 'custodian' ? 'tixie-tech-icon-cust fas fa-broom fa-2x' : '') +
                                        (ticket.specialization_id.name     == 'carpenter' ? 'tixie-tech-icon-carp fas fa-hammer fa-2x' : '')}">
                                        </span>

                                        <p>
                                            <!--                                    <p th:href="@{'/tickets/author/'+${ticket.authorId.id}}">-->
                                            Created by: <span th:text="${ticket.authorId.getuserName()}"/>
                                            <!--                                    </p>-->
                                        </p>

                                        <p>
                                            <!--                                    <p th:href="@{'/tickets/tech/'+${ticket.ownerId.id}}">-->
                                            Assigned to: <span th:text="${ticket.ownerId.getuserName()}"/>
                                            <!--                                    </p>-->
                                        </p>
                                        <p>
                                            <!--                                    <p th:href="@{'/tickets/tech/'+${ticket.ownerId.id}}">-->
                                            Details: <span th:text="${ticket.issue_details}"/>
                                            <!--                                    </p>-->
                                        </p>
                                        <div th:each="note : ${notes}">
                                            <div th:each="note : ${note}">
                                                <th:block th:if="${note.getTicket_id().id} == ${ticket.id}">
                                                    <p>Notes: <span th:text="${note.description}"/></p>
                                                </th:block>
                                            </div>
                                        </div>

                                    </div>
                                </div>


                                <p>
                                    <a th:href="@{'/tech/ticket/'+${ticket.id}}">
                                        <button>
                                            View Ticket
                                        </button>
                                    </a>
                                </p>
                            </div>

                        </th:block>
                    </ul>
                </div>
            </div>
        </div>
    </div>

</div>
</body>
<footer>
    <th:block th:include="partials/common :: footer">
    </th:block>
</footer>
</html>